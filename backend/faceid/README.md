# Face Recognition System

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∂–∏–≤–æ—Å—Ç–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü** - –î–µ—Ç–µ–∫—Ü–∏—è –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –ø–æ–º–æ—â—å—é InsightFace
- üõ°Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏** - –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø—É—Ñ–∏–Ω–≥-–∞—Ç–∞–∫ (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
- üíæ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –•—Ä–∞–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ª–∏—Ü –≤ SQLite/PostgreSQL
- üåê **REST API** - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üì± **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python test_face_recognition.py
```

## API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ

- `GET /api/faceid/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- `POST /api/faceid/enroll` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞
- `POST /api/faceid/verify` - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏—Ü–∞
- `POST /api/faceid/verify-multi-frame` - –ú–Ω–æ–≥–æ–∫–∞–¥—Ä–æ–≤–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- `GET /api/faceid/persons` - –°–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª—é–¥–µ–π

### –¢–µ—Å—Ç–æ–≤—ã–µ

- `GET /api/faceid/test-image` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `POST /api/faceid/enroll-test-image` - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `GET /api/faceid/test-verification` - –¢–µ—Å—Ç–æ–≤–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ–ª–æ–≤–µ–∫–∞

```bash
curl -X POST "http://localhost:8000/api/faceid/enroll" \
  -F "id_person=john_doe" \
  -F "name=John Doe" \
  -F "images=@photo1.jpg" \
  -F "images=@photo2.jpg"
```

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏—Ü–∞

```bash
curl -X POST "http://localhost:8000/api/faceid/verify" \
  -F "image=@test_photo.jpg" \
  -F "check_liveness=true"
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `config.py`:

- `THRESHOLD_HIGH_CONFIDENCE = 0.55` - –ü–æ—Ä–æ–≥ –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- `THRESHOLD_MEDIUM_CONFIDENCE = 0.45` - –ü–æ—Ä–æ–≥ —Å—Ä–µ–¥–Ω–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- `DETECTION_MODEL = "buffalo_l"` - –ú–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü–∏–∏ InsightFace
- `EMBEDDING_SIZE = 512` - –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

```json
{
  "verdict": "match|possible_match|not_found|spoof|no_face_detected",
  "id_candidate": "person_id",
  "name_candidate": "Person Name",
  "similarity": 0.85,
  "threshold_used": 0.55,
  "explain": "–ù–∞—É—á–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è",
  "evidence": {
    "probe_face_box": [x, y, w, h],
    "probe_embedding_norm": 1.0,
    "candidate_stats": {...},
    "liveness": "live|spoof|unknown"
  },
  "diagnostics": {
    "detector_confidence": 0.95,
    "lighting_score": 0.8,
    "motion_blur_score": 0.2
  },
  "timestamp": "2024-01-01T12:00:00Z"
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã L2
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ø—É—Ñ–∏–Ω–≥–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- InsightFace
- OpenCV
- FastAPI
- SQLAlchemy
- NumPy

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
